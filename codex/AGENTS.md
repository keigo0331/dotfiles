# エージェント利用ルール

## 基本方針
- 第一言語は日本語とする（認識齟齬を減らし、表現力を高めるため）。
- エージェントは何かを行うとき「目的（なぜ）」と「方法（どうやって）」を併記する。理由と手段を共有し、判断と対応を迅速にするため。

## Git運用
### ブランチ運用
- 作業開始時は最新の main ブランチからブランチを切り、作業を始める。履歴の分岐を最小化するため。
- 調査のみの作業でも必ずブランチを切る。後続の変更と切り分けるため。
- main ブランチへ直接コミットしない。必ずブランチを切り、プルリクエストを経由する。
- main ブランチに戻った際は必ず `git pull` する。最新の状態を保つため。

### コミット運用
- コミットメッセージは日本語かつ丁寧な文体で書く。文脈共有を確実にし、後から読み返しやすくするため。
- コミットメッセージが長くなる場合は「概要」「変更点」「影響範囲」「テスト」などの見出しや箇条書きで構造化し、可読性を上げる。
- `git reset --hard` は使用しない。既存変更の消失や履歴破壊を防ぐため。

### PR運用
- プルリクエストの作成・タイトル・説明の更新は `gh` CLI で行う。統一的なワークフローを保つため。
- 「PR作成をお願いされた場合」は、ブランチをプッシュし `gh` でPR作成後、変更内容に沿うようにタイトルとMarkdown形式の読みやすい説明へ整える。
- PR本文の作成時、改行したいときは改行文字を使わずそのまま改行し、ヒアドキュメントやシェル関数などで作ろうとせずに如実にテキストを作る。

## テストと品質
- 変更範囲に応じてテストやLintを実行する。例: `npm test <path>` や `eslint <path>` などスコープを絞ったコマンドを優先し、フル実行は依頼や必要性がある場合に行う。
- 実行したコマンドと結果を依頼回答やPRで明記し、再現性を確保する。
- 変更は常に最小単位で進め、段階的にコミットする（例: 1ブランチで1モデルなど）。

## 境界ルール（Do / 要相談 / 禁止）
- Do: 既存の社内/公式ツールやスクリプトを優先活用する（例: 既定のAPIクライアントやCLIがあればそれを使う）。
- 要相談: 依存追加、ビルド設定変更、大規模リファクタなど影響が大きい作業は、目的と影響を共有して事前合意を得る。
- 禁止: 秘密鍵やトークンの貼り付け、履歴消失を伴う操作（`git reset --hard`、force push）、個人情報のログ出力。

## リポジトリ構造ガイド
- サブプロジェクトごとに固有の AGENTS.md がある場合、その階層のルールを優先する。
- 主要ディレクトリの役割やエントリーポイントが分かる README / ガイドがあれば先に参照する。
- 分からない場合はルートの README や `symbolic_links.sh` などリポジトリ固有の案内スクリプトを確認する。

## 参照と再利用
### ツール利用の優先順位
- 内製・公式の CLI / SDK / ユーティリティが存在する場合はそれを優先し、同等機能を新規実装しない。
- 標準的な手順やラッパーが不明な場合は、既存スクリプトやテンプレートを探して流用する。

### 参考実装へのナビゲーション
- 推奨パターンや避けるべき実装例がある場合は、依頼時に具体的なファイルパスを示す。例: 「良い例: `nvim/init.lua`」「避ける例: `legacy/old_api.js`」。
- 実装指針が不明な場合は、過去の類似PRや既存モジュールを優先的に参照する。

## ルールの更新
- 本ドキュメントは「生きたルール」として扱い、定期的（目安: 月次）に見直す。
- ルール更新はPR経由で行い、レビュワーを指定して合意形成する。
